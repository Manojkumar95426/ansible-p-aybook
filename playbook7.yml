---
- name: Configuring tomcat10
  hosts: all
  tasks: 
  - name: Install tomcat10
    apt: 
      name: tomcat10
      state: present

  - name: Install tomcat10-admin
    apt: 
      name: tomcat10-admin
      state: present
  - name: copy the customised tomcat-user.xml file
    copy: 
      src: tomcat-users.xml
      dest: /etc/tomcat10
  - name: Change port of tomcat from 8080 to 9090
    replace:
      regexp: 8080
      replace: 9090
      path: /etc/tomcat10/server.xml
  - name: Restart the tomcat10
    service: 
      name: tomcat10
      state: restarted
  - name: pause for 60seconds
    pause: 
      seconds: 60
  - name: check tomcat response on server 1
    uri: 
      url: http://172.31.47.200:9090
      status_code: 200
  - name: check tomcat response on server2
    uri: 
      url: http://172.31.44.160:9090
      status_code: 200    

...
